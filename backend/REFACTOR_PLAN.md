# ä¸šåŠ¡æ¨¡å—é‡æ„æ–¹æ¡ˆ

## ğŸ¯ ç›®æ ‡æ¶æ„

```
src/
â”œâ”€â”€ apps/                    # ä¸šåŠ¡åº”ç”¨æ¨¡å—
â”‚   â”œâ”€â”€ sop/                # SOPæ ‡å‡†ä½œä¸šç¨‹åº
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ dao/
â”‚   â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ schemas/
â”‚   â”‚   â””â”€â”€ tests/
â”‚   â”œâ”€â”€ agents/             # æ™ºèƒ½ä½“ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ dao/
â”‚   â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ schemas/
â”‚   â”‚   â”œâ”€â”€ workflows/      # æ™ºèƒ½ä½“å·¥ä½œæµå®šä¹‰
â”‚   â”‚   â””â”€â”€ tests/
â”‚   â”œâ”€â”€ mcp/                # MCPæœåŠ¡å™¨ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ dao/
â”‚   â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ schemas/
â”‚   â”‚   â””â”€â”€ tests/
â”‚   â”œâ”€â”€ ai_models/          # AIæ¨¡å‹ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ dao/
â”‚   â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ schemas/
â”‚   â”‚   â””â”€â”€ tests/
â”‚   â”œâ”€â”€ users/              # ç”¨æˆ·æƒé™ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ dao/
â”‚   â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ schemas/
â”‚   â”‚   â””â”€â”€ tests/
â”‚   â”œâ”€â”€ workflows/          # å·¥ä½œæµå¼•æ“
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ dao/
â”‚   â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ schemas/
â”‚   â”‚   â”œâ”€â”€ engine/         # å·¥ä½œæµæ‰§è¡Œå¼•æ“
â”‚   â”‚   â””â”€â”€ tests/
â”‚   â””â”€â”€ monitoring/         # ç›‘æ§å‘Šè­¦
â”‚       â”œâ”€â”€ api/
â”‚       â”œâ”€â”€ services/
â”‚       â”œâ”€â”€ dao/
â”‚       â”œâ”€â”€ models/
â”‚       â”œâ”€â”€ schemas/
â”‚       â””â”€â”€ tests/
â”œâ”€â”€ shared/                 # å…±äº«æ¨¡å—
â”‚   â”œâ”€â”€ core/              # æ ¸å¿ƒå·¥å…·
â”‚   â”‚   â”œâ”€â”€ logging.py
â”‚   â”‚   â”œâ”€â”€ middleware.py
â”‚   â”‚   â”œâ”€â”€ security.py
â”‚   â”‚   â”œâ”€â”€ config.py
â”‚   â”‚   â””â”€â”€ dependencies.py
â”‚   â”œâ”€â”€ db/                # æ•°æ®åº“åŸºç¡€è®¾æ–½
â”‚   â”‚   â”œâ”€â”€ base_dao.py
â”‚   â”‚   â”œâ”€â”€ base_model.py
â”‚   â”‚   â”œâ”€â”€ config.py
â”‚   â”‚   â”œâ”€â”€ transaction.py
â”‚   â”‚   â””â”€â”€ migrations/
â”‚   â”œâ”€â”€ utils/             # é€šç”¨å·¥å…·
â”‚   â”‚   â”œâ”€â”€ datetime.py
â”‚   â”‚   â”œâ”€â”€ crypto.py
â”‚   â”‚   â”œâ”€â”€ validators.py
â”‚   â”‚   â””â”€â”€ helpers.py
â”‚   â”œâ”€â”€ exceptions/        # ç»Ÿä¸€å¼‚å¸¸å¤„ç†
â”‚   â”‚   â”œâ”€â”€ base.py
â”‚   â”‚   â”œâ”€â”€ business.py
â”‚   â”‚   â””â”€â”€ handlers.py
â”‚   â””â”€â”€ tools/             # é€šç”¨å·¥å…·é›†
â”‚       â”œâ”€â”€ elasticsearch_tool.py
â”‚       â”œâ”€â”€ mysql_tool.py
â”‚       â”œâ”€â”€ ssh_tool.py
â”‚       â””â”€â”€ zabbix_tool.py
â”œâ”€â”€ knowledge_base/        # çŸ¥è¯†åº“ï¼ˆç‹¬ç«‹æ¨¡å—ï¼‰
â”œâ”€â”€ main.py               # åº”ç”¨å…¥å£
â””â”€â”€ scripts/              # éƒ¨ç½²è„šæœ¬
```

## ğŸ”„ è¿ç§»æ˜ å°„

### ç°æœ‰ â†’ æ–°æ¶æ„æ˜ å°„å…³ç³»

| ç°æœ‰ä½ç½® | æ–°ä½ç½® | è¯´æ˜ |
|---------|--------|------|
| `api/endpoints/sop.py` | `apps/sop/api/endpoints.py` | SOP API |
| `services/sop_service.py` | `apps/sop/services/sop_service.py` | SOPæœåŠ¡ |
| `db/dao/sop_dao.py` | `apps/sop/dao/sop_dao.py` | SOPæ•°æ®è®¿é—® |
| `schemas/sop.py` | `apps/sop/schemas/` | SOPæ•°æ®ç»“æ„ |
| `api/endpoints/agents.py` | `apps/agents/api/endpoints.py` | æ™ºèƒ½ä½“API |
| `services/agent_service.py` | `apps/agents/services/agent_service.py` | æ™ºèƒ½ä½“æœåŠ¡ |
| `agents/diagnostic_agent/` | `apps/agents/workflows/diagnostic/` | è¯Šæ–­æ™ºèƒ½ä½“å·¥ä½œæµ |
| `api/endpoints/mcp.py` | `apps/mcp/api/endpoints.py` | MCP API |
| `services/mcp_service.py` | `apps/mcp/services/mcp_service.py` | MCPæœåŠ¡ |
| `api/endpoints/ai_models.py` | `apps/ai_models/api/endpoints.py` | AIæ¨¡å‹API |
| `services/user_service.py` | `apps/users/services/user_service.py` | ç”¨æˆ·æœåŠ¡ |
| `core/` | `shared/core/` | æ ¸å¿ƒå·¥å…·å…±äº« |
| `db/dao/base_dao.py` | `shared/db/base_dao.py` | åŸºç¡€DAOå…±äº« |
| `tools/` | `shared/tools/` | é€šç”¨å·¥å…·å…±äº« |

## ğŸš€ é‡æ„æ­¥éª¤

### é˜¶æ®µ1ï¼šåˆ›å»ºæ–°ç›®å½•ç»“æ„
1. åˆ›å»º `apps/` å’Œ `shared/` ç›®å½•
2. æŒ‰ä¸šåŠ¡æ¨¡å—åˆ›å»ºå­ç›®å½•
3. åˆ›å»ºå„æ¨¡å—çš„æ ‡å‡†ç›®å½•ç»“æ„

### é˜¶æ®µ2ï¼šè¿ç§»å…±äº«æ¨¡å—
1. è¿ç§» `core/` â†’ `shared/core/`
2. æ‹†åˆ† `db/` â†’ `shared/db/` + å„æ¨¡å—çš„models
3. è¿ç§» `tools/` â†’ `shared/tools/`

### é˜¶æ®µ3ï¼šæŒ‰ä¸šåŠ¡æ¨¡å—è¿ç§»
1. SOPæ¨¡å—è¿ç§»
2. Agentsæ¨¡å—è¿ç§»
3. MCPæ¨¡å—è¿ç§»
4. å…¶ä»–æ¨¡å—ä¾æ¬¡è¿ç§»

### é˜¶æ®µ4ï¼šæ›´æ–°å¯¼å…¥è·¯å¾„
1. æ›´æ–°æ‰€æœ‰æ¨¡å—çš„importè¯­å¥
2. è°ƒæ•´ä¾èµ–å…³ç³»
3. æ›´æ–°é…ç½®æ–‡ä»¶

### é˜¶æ®µ5ï¼šæµ‹è¯•éªŒè¯
1. å•å…ƒæµ‹è¯•è°ƒæ•´
2. é›†æˆæµ‹è¯•éªŒè¯
3. APIå…¼å®¹æ€§æµ‹è¯•

## ğŸ’¡ é‡æ„ä¼˜åŠ¿

### å¤šäººå¼€å‘
- æ¯ä¸ªå›¢é˜Ÿæˆå‘˜è´Ÿè´£ç‰¹å®šçš„appæ¨¡å—
- å‡å°‘ä»£ç å†²çª
- ç‹¬ç«‹çš„æµ‹è¯•å’ŒCI/CD

### å¾®æœåŠ¡å‡†å¤‡
- æ¯ä¸ªappéƒ½æ˜¯å®Œæ•´çš„ä¸šåŠ¡å•å…ƒ
- æ¸…æ™°çš„æ¨¡å—è¾¹ç•Œ
- æ˜“äºæå–ä¸ºç‹¬ç«‹æœåŠ¡

### ç»´æŠ¤æ€§
- ä¸šåŠ¡é€»è¾‘å†…èš
- ä¾èµ–å…³ç³»æ¸…æ™°
- æ›´å®¹æ˜“å®šä½é—®é¢˜

### æ‰©å±•æ€§
- æ–°åŠŸèƒ½æ¨¡å—åŒ–å¼€å‘
- æ’ä»¶å¼æ¶æ„
- æ”¯æŒåŠ¨æ€åŠ è½½

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å‘åå…¼å®¹**ï¼šç¡®ä¿APIç«¯ç‚¹è·¯å¾„ä¸å˜
2. **å¯¼å…¥è·¯å¾„**ï¼šéœ€è¦å…¨é¢æ›´æ–°importè¯­å¥
3. **é…ç½®ç®¡ç†**ï¼šç»Ÿä¸€é…ç½®vsæ¨¡å—é…ç½®çš„å¹³è¡¡
4. **æ•°æ®åº“**ï¼šmodelsåˆ†æ•£vsç»Ÿä¸€ç®¡ç†çš„æƒè¡¡
5. **æµ‹è¯•è¦†ç›–**ï¼šç¡®ä¿é‡æ„åæµ‹è¯•ä¸é—æ¼